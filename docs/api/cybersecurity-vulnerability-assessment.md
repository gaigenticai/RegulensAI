# Cybersecurity Service - Vulnerability Assessment API

## Endpoint Information

**URL**: `/api/v1/cybersecurity/vulnerabilities/assess`  
**Method**: `POST`  
**Service**: Cybersecurity Service  
**Port**: 8084  

## Description

Initiates comprehensive vulnerability assessments for systems, applications, and infrastructure. This endpoint provides automated vulnerability scanning, risk scoring, and remediation recommendations using industry-standard vulnerability databases and assessment methodologies.

## Authentication

**Required**: Yes  
**Type**: Bearer Token  
**Header**: `Authorization: Bearer <jwt_token>`

## Request Schema

### Headers
```
Content-Type: application/json
Authorization: Bearer <jwt_token>
X-Request-ID: <unique_request_id>
X-Assessment-Priority: <LOW|MEDIUM|HIGH|CRITICAL>
```

### Request Body
```json
{
  "title": "string",
  "description": "string",
  "assessment_type": "string",
  "scope": {
    "targets": [
      {
        "target_type": "string",
        "target_id": "string",
        "ip_address": "string",
        "hostname": "string",
        "port_range": "string"
      }
    ],
    "exclusions": ["string"],
    "scan_depth": "string"
  },
  "methodology": "string",
  "severity_threshold": "string",
  "scheduled_date": "string (ISO 8601)",
  "recurring_schedule": {
    "enabled": "boolean",
    "frequency": "string",
    "interval": "number"
  },
  "notification_settings": {
    "notify_on_completion": "boolean",
    "notify_on_critical": "boolean",
    "recipients": ["string"]
  },
  "compliance_frameworks": ["string"],
  "custom_checks": [
    {
      "check_id": "string",
      "check_name": "string",
      "parameters": "object"
    }
  ]
}
```

### Field Descriptions

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `title` | String | Yes | Assessment title for identification |
| `description` | String | Yes | Detailed description of assessment scope |
| `assessment_type` | String | Yes | Type: "NETWORK", "WEB_APP", "MOBILE_APP", "INFRASTRUCTURE", "CLOUD" |
| `scope.targets` | Array | Yes | List of targets to assess |
| `scope.targets[].target_type` | String | Yes | Target type: "HOST", "NETWORK", "APPLICATION", "SERVICE" |
| `scope.targets[].ip_address` | String | No | IP address or CIDR range |
| `scope.targets[].hostname` | String | No | Hostname or FQDN |
| `scope.targets[].port_range` | String | No | Port range (e.g., "80,443,8080-8090") |
| `methodology` | String | Yes | Methodology: "OWASP", "NIST", "PTES", "OSSTMM" |
| `severity_threshold` | String | Yes | Minimum severity: "LOW", "MEDIUM", "HIGH", "CRITICAL" |
| `scheduled_date` | String | No | When to run assessment (ISO 8601) |
| `compliance_frameworks` | Array | No | Frameworks: "PCI_DSS", "SOC2", "ISO27001", "NIST_CSF" |

## Response Schema

### Success Response (202 Accepted)
```json
{
  "success": true,
  "data": {
    "assessment_id": "uuid",
    "title": "string",
    "status": "string",
    "assessment_type": "string",
    "methodology": "string",
    "scope_summary": {
      "total_targets": "number",
      "target_types": ["string"],
      "estimated_duration": "string"
    },
    "scheduling": {
      "scheduled_date": "string (ISO 8601)",
      "estimated_completion": "string (ISO 8601)",
      "recurring_enabled": "boolean"
    },
    "progress_tracking": {
      "current_phase": "string",
      "completion_percentage": "number",
      "phases": [
        {
          "phase_name": "string",
          "status": "string",
          "estimated_duration": "string"
        }
      ]
    },
    "preliminary_results": {
      "targets_scanned": "number",
      "vulnerabilities_found": "number",
      "critical_findings": "number",
      "high_findings": "number"
    },
    "created_at": "string (ISO 8601)",
    "updated_at": "string (ISO 8601)",
    "created_by": "uuid"
  },
  "message": "Vulnerability assessment initiated successfully"
}
```

### Error Response (400 Bad Request)
```json
{
  "success": false,
  "error": "Invalid assessment configuration",
  "details": {
    "field_errors": [
      {
        "field": "string",
        "message": "string"
      }
    ]
  }
}
```

## Response Field Descriptions

| Field | Type | Description |
|-------|------|-------------|
| `assessment_id` | UUID | Unique identifier for the assessment |
| `status` | String | Assessment status: "QUEUED", "RUNNING", "COMPLETED", "FAILED", "CANCELLED" |
| `current_phase` | String | Current assessment phase: "DISCOVERY", "SCANNING", "ANALYSIS", "REPORTING" |
| `completion_percentage` | Number | Assessment progress (0-100) |
| `vulnerabilities_found` | Number | Total vulnerabilities discovered |
| `critical_findings` | Number | Number of critical severity vulnerabilities |

## Example Usage

### cURL Example
```bash
curl -X POST "https://api.regulateai.com/api/v1/cybersecurity/vulnerabilities/assess" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." \
  -H "X-Request-ID: req_vuln_123456" \
  -H "X-Assessment-Priority: HIGH" \
  -d '{
    "title": "Quarterly Web Application Security Assessment",
    "description": "Comprehensive security assessment of customer-facing web applications",
    "assessment_type": "WEB_APP",
    "scope": {
      "targets": [
        {
          "target_type": "APPLICATION",
          "hostname": "app.example.com",
          "port_range": "80,443"
        },
        {
          "target_type": "APPLICATION", 
          "hostname": "api.example.com",
          "port_range": "443,8443"
        }
      ],
      "exclusions": ["admin.example.com"],
      "scan_depth": "COMPREHENSIVE"
    },
    "methodology": "OWASP",
    "severity_threshold": "MEDIUM",
    "scheduled_date": "2024-08-15T02:00:00Z",
    "recurring_schedule": {
      "enabled": true,
      "frequency": "QUARTERLY",
      "interval": 3
    },
    "notification_settings": {
      "notify_on_completion": true,
      "notify_on_critical": true,
      "recipients": ["security-team@example.com", "devops@example.com"]
    },
    "compliance_frameworks": ["PCI_DSS", "SOC2"],
    "custom_checks": [
      {
        "check_id": "CUSTOM_001",
        "check_name": "API Rate Limiting Check",
        "parameters": {
          "max_requests_per_minute": 1000,
          "test_duration_seconds": 60
        }
      }
    ]
  }'
```

### Python Example
```python
import requests
import json

url = "https://api.regulateai.com/api/v1/cybersecurity/vulnerabilities/assess"
headers = {
    "Content-Type": "application/json",
    "Authorization": "Bearer " + token,
    "X-Request-ID": "req_vuln_python_001",
    "X-Assessment-Priority": "MEDIUM"
}

payload = {
    "title": "Infrastructure Vulnerability Scan",
    "description": "Monthly vulnerability assessment of production infrastructure",
    "assessment_type": "INFRASTRUCTURE",
    "scope": {
        "targets": [
            {
                "target_type": "NETWORK",
                "ip_address": "10.0.1.0/24",
                "port_range": "22,80,443,3389"
            }
        ],
        "scan_depth": "STANDARD"
    },
    "methodology": "NIST",
    "severity_threshold": "LOW",
    "compliance_frameworks": ["ISO27001", "NIST_CSF"]
}

response = requests.post(url, headers=headers, json=payload)
result = response.json()

if result["success"]:
    assessment_id = result["data"]["assessment_id"]
    print(f"Assessment initiated: {assessment_id}")
    print(f"Estimated completion: {result['data']['scheduling']['estimated_completion']}")
```

## Assessment Methodologies

### OWASP (Web Applications)
- **OWASP Top 10**: Focus on most critical web application risks
- **ASVS**: Application Security Verification Standard
- **Testing Guide**: Comprehensive web application testing methodology
- **API Security**: Specific checks for REST and GraphQL APIs

### NIST (Infrastructure)
- **SP 800-115**: Technical Guide to Information Security Testing
- **Cybersecurity Framework**: Core security functions assessment
- **Risk Management**: Risk-based vulnerability prioritization
- **Controls Assessment**: NIST 800-53 security controls validation

### PTES (Penetration Testing)
- **Pre-engagement**: Scope definition and rules of engagement
- **Intelligence Gathering**: Reconnaissance and information gathering
- **Threat Modeling**: Attack vector identification
- **Vulnerability Analysis**: Comprehensive vulnerability identification
- **Exploitation**: Controlled exploitation of identified vulnerabilities
- **Post-Exploitation**: Impact assessment and lateral movement testing
- **Reporting**: Detailed findings and remediation recommendations

## Vulnerability Databases

### Primary Sources
- **CVE**: Common Vulnerabilities and Exposures database
- **NVD**: National Vulnerability Database (NIST)
- **CVSS**: Common Vulnerability Scoring System
- **CWE**: Common Weakness Enumeration

### Specialized Sources
- **OWASP**: Web application specific vulnerabilities
- **SANS**: Internet Storm Center vulnerability feeds
- **Vendor Advisories**: Microsoft, Adobe, Oracle security bulletins
- **Threat Intelligence**: Commercial threat intelligence feeds

## Assessment Phases

### 1. Discovery Phase
- **Network Discovery**: Identify live hosts and services
- **Service Enumeration**: Determine running services and versions
- **OS Fingerprinting**: Identify operating systems and versions
- **Application Discovery**: Identify web applications and technologies

### 2. Scanning Phase
- **Port Scanning**: Comprehensive port and service scanning
- **Vulnerability Scanning**: Automated vulnerability identification
- **Configuration Assessment**: Security configuration analysis
- **Compliance Checking**: Framework-specific compliance validation

### 3. Analysis Phase
- **Risk Assessment**: CVSS scoring and risk prioritization
- **False Positive Filtering**: Manual validation of findings
- **Impact Analysis**: Business impact assessment
- **Exploitability Assessment**: Determine ease of exploitation

### 4. Reporting Phase
- **Executive Summary**: High-level findings for management
- **Technical Details**: Detailed vulnerability descriptions
- **Remediation Guidance**: Step-by-step fix instructions
- **Compliance Mapping**: Framework requirement mapping

## Performance Specifications

- **Scanning Speed**: Up to 1000 hosts per hour
- **Concurrent Assessments**: Up to 10 simultaneous assessments
- **Database Updates**: Daily vulnerability database updates
- **Report Generation**: < 30 minutes for standard reports
- **API Response Time**: < 5 seconds for assessment initiation

## Security Considerations

1. **Authorized Scanning**: Ensure proper authorization before scanning
2. **Network Impact**: Minimize impact on production systems
3. **Data Protection**: Secure handling of vulnerability data
4. **Access Control**: Role-based access to assessment results
5. **Audit Logging**: Complete audit trail of all activities

## Compliance Integration

### PCI DSS
- **Requirement 11.2**: Quarterly vulnerability scans
- **ASV Compliance**: Approved Scanning Vendor requirements
- **Remediation Tracking**: Fix verification and validation

### SOC 2
- **CC6.1**: Logical access security
- **CC6.7**: System monitoring and vulnerability management
- **CC7.1**: System boundaries and configurations

### ISO 27001
- **A.12.6.1**: Management of technical vulnerabilities
- **A.14.2.3**: Application security testing
- **A.18.2.3**: Technical compliance review

## Related Endpoints

- `GET /api/v1/cybersecurity/vulnerabilities/assess/{id}` - Get assessment status
- `GET /api/v1/cybersecurity/vulnerabilities/assess/{id}/results` - Get assessment results
- `POST /api/v1/cybersecurity/vulnerabilities/assess/{id}/cancel` - Cancel assessment
- `GET /api/v1/cybersecurity/vulnerabilities/reports/{id}` - Download assessment report
- `POST /api/v1/cybersecurity/vulnerabilities/remediate` - Create remediation plan
